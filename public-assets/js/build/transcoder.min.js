(()=>{const t={};let e=!1,i=!1;!function(r){r(document).ready((()=>{r(document).ajaxComplete(((t,e,i)=>{"undefined"!=typeof bp_template_pack&&"legacy"!==bp_template_pack&&bp_template_pack&&"function"==typeof get_parameter&&"activity_filter"===get_parameter("action",i.data)&&setTimeout((()=>{r("#activity-stream > .activity-list > li .media-type-video > .rtmedia-item-thumbnail video").each(((t,e)=>{if(void 0!==(e=r(e)).attr("poster")&&e.attr("poster").length>0||void 0===e.attr("id")||!e.attr("id").length)return;const i=parseInt(e.attr("id").replace(/^\D+/g,""));a(i)})),n()}),1e3)})),r(".rtmedia-container ul.rtmedia-list.rtmedia-list-media.rtm-gallery-list > li.rtmedia-list-item").each(((t,e)=>{const i=(e=r(e)).find("a.rtmedia-list-item-a > .rtmedia-item-thumbnail > img");i.length&&void 0!==i.attr("src")&&-1!==i.attr("src").search("video_thumb.png")&&a(parseInt(e.attr("id")))})),n(),"undefined"!=typeof rtMediaHook&&(rtMediaHook.register("rtmedia_js_file_added",(t=>(void 0===t||void 0===t[2]||-1===t[2].search("#rtmedia_uploader_filelist-activity-")||(e=!0),!0))),rtMediaHook.register("rtmedia_js_after_file_upload",(t=>{if(void 0===t||void 0===t[1]||void 0===t[2])return!0;if("video"!==t[1].type.split("/")[0])return!0;const i=JSON.parse(t[2]);return!0===Array.isArray(i)&&void 0!==i[0]?(a(i[0]),!0===e&&(d(),e=!1),!0):void 0===i.media_id||(a(i.media_id),!0)})),rtMediaHook.register("rtmedia_js_after_files_uploaded",(()=>(n(),!0))),rtMediaHook.register("rtmedia_js_after_activity_added",(()=>(n(),!0))))}));const a=e=>{void 0===t[e]&&(t[e]={})},d=()=>{if(!Object.entries(t).length)return;let e=[];for(const[i,r]of Object.entries(t))void 0!==i&&void 0!==r&&!1===m(r)&&e.push(i);e.length&&(e=e.join(),r.get(rtTranscoder.restURLPrefix+"/transcoder/v1/amp-rtmedia?media_ids="+e,(t=>{o(t)})))},o=(e=!1)=>{if("object"==typeof e)for(const[i,r]of Object.entries(e)){if(void 0===i||void 0===r)continue;const e=parseInt(i);"invalid"!==r?!1!==m(r)&&(t[e]=r,s(e)):void 0!==t[e]&&delete t[e]}n()},n=()=>{!0!==i&&(i=!0,setTimeout((()=>{d(),i=!1}),5e3))},s=e=>{if(void 0===t[e]||!m(t[e]))return;const i=r("li#"+e);if(i.length>0){const r=i.find("div.rtmedia-item-thumbnail > img");if(!r.length)return;return void r.attr("src",t[e].poster)}const a=r("video#rt_media_video_"+e);if(a.length>0)return void a.attr("poster",t[e].poster);const d=r("video#rt_media_video_"+e+"_from_mejs");d.length>0&&d.attr("poster",t[e].poster)},m=t=>void 0!==t.poster}(jQuery)})();