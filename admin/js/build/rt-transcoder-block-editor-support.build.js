(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.apiFetch;var o=e.n(r);const{rtTranscoderBlockEditorSupport:a}=window;wp.hooks.addFilter("editor.BlockEdit","rt-transcoder-amp/set-media-attributes",(e=>r=>{const d=r.attributes,s="amp/amp-story-page"===r.name,i="core/video"===r.name,p=s?d.mediaId:d.id;if(void 0!==p)if(void 0===d.poster)s&&void 0!==d.mediaType&&"video"===d.mediaType&&!d.mediaUrl.endsWith("mp4")?r.setAttributes({poster:a.amp_story_fallback_poster}):i&&void 0!==d.src&&0!==d.src.indexOf("blob:")&&!d.src.endsWith("mp4")&&r.setAttributes({poster:a.amp_video_fallback_poster});else if(d.poster.endsWith("-fallback-poster.png")){const e="/wp-json/transcoder/v1/amp-media";o()({path:`${e} / ${p}`}).then((e=>{!1!==e&&null!==e&&e.poster.length&&e.transcodedMedia.length&&(s&&void 0!==d.mediaType&&"video"===d.mediaType?r.setAttributes({poster:e.poster,mediaUrl:e.transcodedMedia}):i&&r.setAttributes({poster:e.poster,src:e.transcodedMedia}))}))}return(0,t.createElement)(e,{...r})}))})();